(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{45:function(e,t,n){e.exports=n(77)},50:function(e,t,n){},51:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(25),o=(n(50),n(19)),l=n(9),c=n(10),s=n(12),u=n(11),f=n(13),h=n(15),d=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={error:null,errorInfo:null},n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?a.a.createElement("div",{className:"container-fluid"},a.a.createElement("h2",null,"Something went wrong."),a.a.createElement("h4",null,"Please reload page to continue"),a.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),a.a.createElement("br",null),this.state.errorInfo.componentStack)):this.props.children}}]),t}(r.Component),p=(n(51),n(27)),m=n(18),v=n(6),O=n(16),b=n.n(O),g=n(21),y=n(22),j=n.n(y),w="LOAD_CONFIG";function k(){return function(){var e=Object(g.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("http://www.banglarelief.org:9010/config").then(function(e){return e.status}).catch(function(e){console.log("Looks like there was a problem: \n",e)});case 2:n=e.sent,t({type:w,payload:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}var E="FETCH_GROUPS";function C(e){return function(){var t=Object(g.a)(b.a.mark(function t(n){var r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.a.get(e).then(function(e){return e}).catch(function(e){console.log("Looks like there was a problem: \n",e)});case 2:r=t.sent,n({type:E,payload:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}var D=n(23),P=n.n(D),x=n(42),S=n(17),I=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={flash:!1,time:0},n.interval=null,n.flashing=n.flashing.bind(Object(S.a)(n)),n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"flashing",value:function(){this.props.flash?this.setState({time:Date.now(),flash:!this.state.flash}):this.setState({time:Date.now(),flash:!1})}},{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){console.log("interval"),e.flashing()},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this.props,t=e.onRedClick,n=e.onGreenClick,r=e.RedOn,i=e.GreenOn,o=e.Size,l=e.BlackColor,c=(e.DisabledColor,e.RedColor),s=e.RedDim,u=e.GreenColor,f=e.GreenDim,h=e.flash,d=Object(x.a)(e,["onRedClick","onGreenClick","RedOn","GreenOn","Size","BlackColor","DisabledColor","RedColor","RedDim","GreenColor","GreenDim","flash"]),p="";return p=h?this.state.flash?c:s:r?c:s,a.a.createElement("svg",Object.assign({width:"".concat(o,"px"),height:"".concat(o*(1/.375),"px"),viewBox:"0 0 60 110",version:"1.1"},d),a.a.createElement("defs",null,a.a.createElement("circle",{style:{cursor:t?"pointer":void 0},id:"redCirclePath",cx:"30",cy:"30",r:"20"}),a.a.createElement("circle",{style:{cursor:n?"pointer":void 0},id:"greenCirclePath",cx:"30",cy:"80",r:"20"}),a.a.createElement("filter",{x:"-50%",y:"-50%",width:"200%",height:"200%",filterUnits:"objectBoundingBox",id:"shadowFilter"},a.a.createElement("feGaussianBlur",{stdDeviation:"3",in:"SourceAlpha",result:"shadowBlurInner1"}),a.a.createElement("feOffset",{dx:"0",dy:"4",in:"shadowBlurInner1",result:"shadowOffsetInner1"}),a.a.createElement("feComposite",{in:"shadowOffsetInner1",in2:"SourceAlpha",operator:"arithmetic",k2:"-1",k3:"1",result:"shadowInnerInner1"}),a.a.createElement("feColorMatrix",{values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.5 0",type:"matrix",in:"shadowInnerInner1"}))),a.a.createElement("rect",{fill:l,x:"0",y:"0",width:"60",height:"110",rx:"8"}),a.a.createElement("use",{fill:p,fillRule:"evenodd",xlinkHref:"#redCirclePath"}),a.a.createElement("use",{fill:i?u:f,fillRule:"evenodd",xlinkHref:"#greenCirclePath"}),a.a.createElement("g",null,a.a.createElement("use",{onClick:t,fill:"black",fillOpacity:"1",filter:"url(#shadowFilter)",xlinkHref:"#redCirclePath"}),a.a.createElement("use",{onClick:n,fill:"black",fillOpacity:"1",filter:"url(#shadowFilter)",xlinkHref:"#greenCirclePath"})))}}]),t}(r.Component);I.defaultProps={onRedClick:void 0,onGreenClick:void 0,RedOn:!1,GreenOn:!1,Size:60,BlackColor:"#000000",DisabledColor:"#4A4A4A",RedColor:"#FF0000",RedDim:"#FF7777",GreenColor:"#48FF00",GreenDim:"#C2FFAA",flash:!1};var G=I,R="LOAD_URL_STATUS";function F(e,t){var n="http://www.banglarelief.org:9010/health/".concat(e);return function(){var e=Object(g.a)(b.a.mark(function e(t){var r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get(n).then(function(e){return e}).catch(function(e){console.log("Looks like there was a problem: \n",e)});case 2:r=e.sent,t({type:R,payload:r});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var _=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={redOn:!1,greenOn:!1,redCounter:0,time:0,start:0,intervals:0,flash:!1},n.interval=null,n.dataPolling=null,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.duration,r=t.url;this.setState({start:Date.now()}),this.dataPolling=setInterval(function(){var t=e.state.intervals;e.props.loadUrlStatus(r,t),e.setState({intervals:t+1})},1e3*parseInt(n)),this.interval=setInterval(function(){return e.setState({time:Date.now()})},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.dataPolling),clearInterval(this.interval)}},{key:"render",value:function(){return a.a.createElement(G,{Size:50,RedOn:this.state.redOn,GreenOn:this.state.greenOn,flash:this.state.flash,time:this.state.time})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.status.data,r=t.start,a=t.time,i=t.redCounter,o=t.intervals;t.flash;if(void 0!==n.interval&&n.interval!==o){var l=!1;if(200===n.statusCode)return{greenOn:!0,redOn:!1,start:Date.now(),flash:l,redCounter:0};if(200!==n.statusCode)return i>=3?((a-r)/1e3>5&&(l=!0),{greenOn:!1,redOn:!0,redCounter:i+1,flash:l}):{greenOn:!1,redOn:!0,redCounter:i+1,flash:l}}return null}}]),t}(r.Component),A=Object(m.b)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach(function(t){Object(p.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e)},function(e){return Object(v.b)({loadUrlStatus:F},e)})(_);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var L=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.loadConfig(),this.props.fetchGroups()}},{key:"renderTraffic",value:function(){var e=this.props,t=e.config,n=t.data,r=t.groups,i=e.matches.match.params.id;return n[P.a.mapKeys(r,"id")[i].name].map(function(e,t){return a.a.createElement("div",{className:"col-xs-12 col-md-3"},a.a.createElement("div",null,a.a.createElement(A,{url:e.url,duration:e.interval_check})),a.a.createElement("div",null,e.url))})}},{key:"renderTrafficList",value:function(e){return e.map(function(e,t){return a.a.createElement(a.a.Fragment,null,a.a.createElement("ul",null,a.a.createElement("li",{key:e.group_id+e.url+t},"id: ",e.group_id),a.a.createElement("li",null,"url: ",e.url),a.a.createElement("li",null,"interval check: ",e.interval_check)))})}},{key:"renderConfig",value:function(e){var t=this,n=this.props.config.groups;return Object.keys(e).map(function(r,i){var l=e[r],c=P.a.mapKeys(n,"name")[r];return a.a.createElement("div",{className:"top-buffer",key:c.id+r+i},a.a.createElement("h4",null,a.a.createElement(o.b,{to:"/health/".concat(c.id)},r)),t.renderTrafficList(l))})}},{key:"render",value:function(){var e=this.props,t=e.config,n=t.data,r=t.groups,i=e.matches.match.params.id;return void 0!==i&&parseInt(i)>0&&void 0!==r&&Object.keys(r).length>0?a.a.createElement("div",{className:"container-fluid"},a.a.createElement("header",null,a.a.createElement("h2",{className:"text-center top-buffer"},"Configuration ",P.a.mapKeys(r,"id")[i].name)),a.a.createElement("div",{className:"row-fluid"},this.renderTraffic())):a.a.createElement("div",{className:"container-fluid"},a.a.createElement("header",null,a.a.createElement("h1",{className:"text-center top-buffer"},"Health Check")),a.a.createElement("div",{className:"row-fluid"},"Page is used to check health of external services. The following configurations are available to load"),a.a.createElement("div",{className:"row-fluid"},this.renderConfig(n)))}}]),t}(r.Component);var T=Object(m.b)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach(function(t){Object(p.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e)},function(e){return Object(v.b)({loadConfig:k,fetchGroups:C},e)})(L),U=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"App"},a.a.createElement(d,null,a.a.createElement(h.c,null,a.a.createElement(h.a,{path:"/health/:id",render:function(t){return a.a.createElement(T,Object.assign({matches:t},e.props))}}),a.a.createElement(h.a,{exact:!0,path:"/",render:function(t){return a.a.createElement(T,Object.assign({matches:t},e.props))}}))))}}]),t}(r.Component),H=Object(h.f)(U);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=n(44);var M=Object(v.c)({config:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:[],groups:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:var n=t.payload.reduce(function(e,t){var n=t.group_id,r=t.name,a=t.url,i=t.interval_check;e[r]||(e[r]=[]);var o={group_id:n,name:r,url:a,interval_check:i};return e[r].push(o),e},{});return Object.assign({},e,{data:n});case E:return Object.assign({},e,{groups:t.payload});default:return e}},status:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object.assign({},e,{data:t.payload});default:return e}}});n(76);var W,K=Object(v.e)(M,W,Object(v.d)(Object(v.a)(z.a)));Object(i.render)(a.a.createElement(m.a,{store:K},a.a.createElement(o.a,null,a.a.createElement(H,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[45,1,2]]]);
//# sourceMappingURL=main.de802401.chunk.js.map